<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.oracle.ohTravel.Member">
	<!-- 로그인 -->
	<select id="login" parameterType="MemberDTO" resultType="MemberDTO">
		SELECT *
		FROM member
		WHERE mem_id = #{mem_id}
		AND mem_password = #{mem_password}
	</select>
	
	<!-- 회원가입 -->
	<insert id="register" parameterType="MemberDTO">
		INSERT INTO member (
							mem_id,
							mem_name,
							mem_password,
							mem_email,
							mem_tel,
							mem_birthday,
							mem_create,
							mem_role	)
					VALUES(
							#{mem_id},
							#{mem_name},
							#{mem_password},
							#{mem_email},
							#{mem_tel},
							#{mem_birthday},
							now(),
							#{mem_role}	);
		INSERT INTO mem_membership (
									mem_id,
									membership_id,
									mem_mile	)
							VALUES (
									#{mem_id},
									#{membership_id},
									#{mem_mile}		);
	</insert>
	
	<!-- 아이디 중복 검사 -->
	<select id="idCheck" resultType="int">
		SELECT count(*) FROM member WHERE mem_id = #{mem_id}
	</select>
	
	<!-- 회원 탈퇴 -->
	<delete id="deleteMember" parameterType="MemberDTO"> 
		DELETE FROM member
		WHERE mem_id = #{mem_id}
		AND	mem_password = #{mem_password}
	</delete>
	
	<!-- 개인 정보 수정 -->
	<update id="updateMember">
		UPDATE member SET
			mem_tel = #{mem_tel},
			mem_email = #{mem_email},
			mem_birthday = #{mem_birthday}
		WHERE mem_id = #{mem_id}
	</update>
	
	<!-- 비밀번호 변경 -->
	<update id="updatePassword">
		UPDATE password SET
			mem_password = #{mem_password}
		WHERE mem_id = #{mem_id}
	</update>
	
	<!-- 티켓 예약 내역 조회 -->
	<select id="ticketReservList" resultType="TicketReservationDTO" parameterType="TicketReservationDTO">
		SELECT * FROM ticket_reservation WHERE mem_id = #{mem_id}
	</select>
	
	<!-- 항공 예약 내역 조회 -->
	<select id="airReservList" resultType="AirReservationDTO" parameterType="AirReservationDTO">
		SELECT * FROM reservation WHERE mem_id = #{mem_id}
	</select>
	
	<!-- 호텔 예약 내역 조회 -->
	<select id="hotelReservList" resultType="HotelReservationDTO" parameterType="HotelReservationDTO">
		SELECT * FROM hotel_reservation WHERE mem_id = #{mem_id}
	</select>
	
	<!-- 패키지 예약 내역 조회 -->
	<select id="packageReservList" resultType="PackageReservationDTO" parameterType="PackageReservationDTO">
		SELECT * FROM package_reservation WHERE mem_id = #{mem_id}
	</select>
	
</mapper>